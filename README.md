MinifyX-for-Evolution
=====================
Component MinifyX for MODX Evolution

Базовая настройка
----------
- Залить папку assets в корень вашего сайта
- Создать сниппет MinifyX с кодом из файла **snippet.txt**

Расширенная настройка
----------
- Создать плагин MinifyX с кодом из файла **plugin.txt** и привязать к событию OnDocFormSave
- Создать модуль MinifyX с кодом из файал **module.txt**
- Создать новый документ MinifyX для кастомных CSS стилей с шаблоном blank и типом содержимого text/css
- Создать новый документ MinifyX для кастомных JS скриптов с шаблоном blank и типом содержимого text/javascript
- В настройках модуля на вкладке конфигурация добавить параметр &CSSfile=CSS файлы;textarea; &JSfile=JS файлы;textarea; &CSSdoc=ID CSS документа;int; &JSdoc=ID JS документа;int;
- В параметры ID JS документа и ID CSS документа вписать ID ранее созданных документов
- В параметры JS файлы и CSS файлы вписать полный путь от корня сайта к файлам которые необходимо сжимать. Если несколько файлов одного типа, то их следует разделять запятой
- Поставить галочку "общие параметры" и сохранить модуль
- Опять открыть модуль на редактирование и зайти на вкладку зависимости. Затем запустить управление зависимостями и добавить плагин MinifyX в зависимость.

Возможности при базовой настройке
----------
Запуск сниппета с параметрами **не рекомендуется**

	[!MinifyX? &CSSfile=`assets/templates/tpl/css/bootstrap.css,assets/js/prettify/prettify.css` &CSSdoc=`2` &JSfile=`assets/js/jquery-1.8.3.min.js,assets/templates/tpl/js/modernizr.custom.28468.js,assets/js/jquery.validate.js,assets/js/jquery.form.min.js,assets/js/prettify/prettify.js` &JSdoc=`3` &parse=`1`!]

Параметры сниппета
-------
- **CSSfile** Список файлов с CSS стилями, которые нужно включить в конечный файл и сжать
- **CSSdoc** ID документа в дереве документов с CSS стилями
- **JSfile** Список файлов с JavaScript кодом, которые нужно включить в конечный файл и сжать
- **JSdoc** ID документа в дереве документов с JavaScript кодом
- **parse** Обрабатывать ли MODX теги в документах созданных в дереве документов
- **cssFile** имя CSS файла на выходе. По умолчанию style.css
- **jsFile** имя JS файла на выходе. По умолчанию script.js
- **outFolder** в какую папку сохранять сжатый файл. По умолчанию assets/cache/
- **API** режим запуска сниппета. По умолчанию происходит API отключен и в случае успешного выполнения кода сжатые скрипты добавляются в секцию head вашего веб-сайта. Если же режим API включен (для включение необходимо указать любое значение этому параметру), то результат своей работы сниппет отдает в виде массива array('js'=>'путь к сжатому JS скрипту','css'=>'путь к не сжатому CSS скрипту'); В случае если сжать файл не удалось или какой-то тип файлов не требовалось сжимать, то этот элемент массива будет пуст.

Возможности при расширенной настройке
--------
- Автоматическое пересоздание CSS или JS файла при изменении документа с CSS стилями и JS кодом соответственно
**ВАЖНО!!!** Если в этих документах используются MODX теги и значение этих тегов зависит от других документов, то необходима донастройка плагина и изменение контролирующего события, чтобы файлы пересоздавались при каждой отчистке кеша MODX. Но делать этого я не рекомендую. Лучше просто исключите этот документ из настроек MinifyX и подключайте его в шаблоне как src="[~id~]"
- Возможность ручного пересоздания сжатых файлов при помощи запуска модуля

К сведению
---------
- В разделе отчеты->просмотр событий плагин создает новые уведомления о результате своей работы. Туда же помещается отладочная информация с сериализованым стеком вызова при возникновени ошибок
- При расширенной конфигурации в шаблонах необходимо самостоятельно прописать подключение сжатых JS и CSS файлов. По умолчанию это 
	
	<link rel="stylesheet" type="text/css" href="/assets/cache/style.css" />
	<link rel="stylesheet" type="text/css" href="/assets/cache/script.js" />
	
TODO
--------
- В имя файла добавлять хеш для принудительной загрузки измененого файла
- Если файл существует и хеш имени совпадает с текущим хешем документов, то сразу делать return данных, а не сжимать повторно 
- Вынесение всех опций в параметры сниппета и на вкладку конфигурация в модуль
- Больше валидаций в MinifyX.core.php
- Поддержка сразу нескольких документов одного типа из дерева документов
- Инсталлятор, т.к. очень много кнопочек нужно кликнуть для полной настройки